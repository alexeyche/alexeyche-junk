J
hist(J)
10000*10:-3
10000*10:-3
10000*10^-3
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
s <- seq(-40,60,length.out=1000); plot(s, W(s), type="l")
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
cumsum(x)
cumsum(x)<1
which(cumsum(x)<1)
labmda <- 10
tt <- 1
maxN = round(qpois(0.99999,tt*lambda))+10 # large enough so that the chance of needing a larger sample is tiny
lambda <- 10
maxN = round(qpois(0.99999,tt*lambda))+10 # large enough so that the chance of needing a larger sample is tiny
maxN
maxN = round(qpois(0.99999,tt*lambda))+10 # large enough so that the chance of needing a larger sample is tiny
maxN
(qpois(0.99999,tt*lambda)
qpois(0.99999,tt*lambda)
qpois(0.99999,tt/lambda)
qpois(0.99999,tt/lambda)
qpois(0.99999,tt/lambda)
qpois(0.99999,tt/lambda)
x = matrix(rexp(ntrials*maxN,lambda),ntrials,maxN)
x = matrix(rexp(100*maxN,lambda),ntrials,maxN)
x = matrix(rexp(100*maxN,lambda),100,maxN)
x
plot(x)
x = matrix(rexp(ntrials*maxN,lambda),ntrials,maxN)
x = matrix(rexp(ntrials*maxN,lambda),ntrials,maxN)
ntrials<-100
maxN = round(qpois(0.99999,tt*lambda))+10 # large enough so that the chance of needing a larger sample is tiny
labmda
maxN
x = matrix(rexp(ntrials*maxN,lambda),ntrials,maxN)
x
plot(x)
apply(x,1,getN,tt=tt)
hist(apply(x,1,getN,tt=tt))
plot(apply(x,1,getN,tt=tt))
simPP(100, 0.01, 10)
source('~/.active-rstudio-document', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
rexp(ntrials*maxN,lambda)
ntrials
maxN = round(qpois(0.99999,tt*lambda))+10
maxN
matrix(rexp(ntrials*maxN,lambda),ntrials,maxN)
x = matrix(rexp(ntrials*maxN,lambda),ntrials,maxN)
View(x)
plot(simPP(100, 0.1, 10))
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
plot(simPP(100, 0.1, 10))
plot(simPP(100, 0.1, 10))
plot(simPP(100, 0.001, 10))
plot(simPP(100, 1, 10))
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
s=0; v=seq(0,Tmax,length=1000)
Tmax <- 1000
s=0; v=seq(0,Tmax,length=1000)
lambda=function(x) 100*(sin(x*pi)+1)
lambda(v)
plot(lambda(v))
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
length(X)
X[0]
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
Lambda=function(t) integrate(f=lambda,lower=0,upper=t)$value
Lambda
Lambda(10)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
f(1)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
f(1)
Lambda <- function(t) integrate(f=lambda_const,lower=0,upper=t)$value
Lambda(10)
Lambda(1)
Lambda(15)
Lambda <- function(t) integrate(f=lamda_sin,lower=0,upper=t)$value
Lambda(15)
lambda_sin=function(x) 100*(sin(x*pi)+1)
Lambda(15)
Lambda <- function(t) integrate(f=lambda_sin,lower=0,upper=t)$value
Lambda(15)
Lambda(11)
Lambda(10)
Lambda(1)
Lambda(0)
Lambda(-1)
simPP(10)
simPP(10,1,10)
simPP(10,0.01,10)
simPP(10,0.5,10)
simPP(10,0.1,10)
simPP(10,0.1,10)
simPP(10,0.1,10)
simPP(10,0.1,10)
simPP(10,0.1,10)
simPP(10,0.1,10)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
u=runif(1)
u
log(u)
log(u)
log(u)
log(u)
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
log(runif(1))
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
draw_pp(10, 100)
draw_pp(10, 100)
draw_pp(10, 100)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
draw_pp(10, 100)
draw_pp(10, 100)
draw_pp(10, 100)
draw_pp(10, 100)
draw_pp(1, 100)
draw_pp(1, 100)
draw_pp(1, 100)
draw_pp(1, 100)
u=runif(ntrials)
ntrials <- 100
u=runif(ntrials)
u
t=t-log(u)/lambda
t
t
which(t<=t_max)
t_max <- 100
which(t<=t_max)
k[t<=t_max] <- k[t<=t_max] +1
k
k <- numeric(nrials)
k <- numeric(ntrials)
k
k[t<=t_max]
k[t<=t_max] <- k[t<=t_max]+1
k
t
t < t_max
.all(t < t_max)
sum(t < t_max)
t < t_max == TRUE
(t < t_max) == TRUE
c(TRUE,TRUE,FALSE)
c(TRUE,TRUE,FALSE) == TRUE
c(TRUE,TRUE,FALSE) == FALSE
c(TRUE,TRUE,FALSE) & FALSE
c(TRUE,TRUE,FALSE) && FALSE
c(TRUE,TRUE,FALSE) && TRUE
c(TRUE,TRUE,FALSE) || TRUE
c(TRUE,TRUE,FALSE) | TRUE
c(TRUE,TRUE,FALSE) & TRUE
c(TRUE,TRUE,FALSE) && TRUE
c(TRUE,TRUE,FALSE) && FALSE
c(TRUE,TRUE) && FALSE
FALSE & TRUE
FALSE && TRUE
c(TRUE,TRUE,FALSE) && FALSE
c(TRUE,TRUE,FALSE) || FALSE
c(TRUE,TRUE,FALSE) || TRUE
c(TRUE,TRUE,FALSE) || TRUE
c(TRUE,TRUE) || TRUE
c(TRUE,TRUE) || FALSE
?"&&"
isTrue(c(TRUE,TRUE,FALSE))
isTRUE(c(TRUE,TRUE,FALSE))
isTRUE(c(TRUE,TRUE))
xor(c(TRUE,TRUE,FALSE), TRUE)
all(k_cont)
k_cont <- t <= t_max
k_cont
all(k_cont == TRUE
all(k_cont == TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
draw_pp(100, 10, 100)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
draw_pp(100, 10, 100)
draw_pp(100, 10, 100)
draw_pp(100, 10, 100)
draw_pp(100, 10, 100)
draw_pp(100, 10, 100)
draw_pp(100, 1, 100)
draw_pp(100, 1, 1)
hist(draw_pp(1000, 1, 1))
hist(draw_pp(1000, 10, 0.1))
hist(draw_pp(1000, 10, 0.1))
hist(draw_pp(1000, 10, 0.1))
draw_pp(1000, 10, 0.1)
draw_pp(1000, 10, 0.01)
plot(draw_pp(1000, 10, 0.01))
plot(draw_pp(1000, 10, 0.005))
plot(draw_pp(1000, 10, 0.001))
plot(draw_pp(1000, 10, 0.001))
plot(draw_pp(1000, 10, 0.001))
plot(draw_pp(1000, 10, 0.001))
plot(draw_pp(1000, 10, 0.001))
plot(draw_pp(1000, 10, 0.001))
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
T
T
t
s<-seq(0,100, length.out=1000); s<-plot(s,epsp(s), type="l")
draw_pp(100, 100, 100)
draw_pp(100, 10, 100)
mean(draw_pp(100, 10, 100))
mean(draw_pp(100, 10, 10))
mean(draw_pp(100, 10, 1))
mean(draw_pp(100, 10, 1))
mean(draw_pp(100, 10, 1))
mean(draw_pp(100, 10, 1))
mean(draw_pp(10000, 10, 1))
mean(draw_pp(10000, 10, 1))
mean(draw_pp(10000, 10, 1))
mean(draw_pp(10000000, 10, 1))
mean(draw_pp(1000000, 10, 1))
mean(draw_pp(100000, 10, 1))
mean(draw_pp(100000, 10, 1))
mean(draw_pp(100000, 10, 1))
source('~/.active-rstudio-document', echo=TRUE)
lambda(1)
integrate(lambda)
integrate(lambda, lower=0)
integrate(lambda, lower=0,upper=100)
?integrate
integrate(lambda, lower=0,upper=1)
?Vectorize
Vectorize(lambda)
Vectorize(lambda)(1)
Vectorize(lambda)(c(1,2,3))
integrate(Vectorize(lambda), lower=0, upper=100
integrate(Vectorize(lambda), lower=0, upper=100)
integrate(Vectorize(lambda), lower=0, upper=100000)
epsp_lambda_in <- function(s) { epsp(s)*lambda(-s) }
integrate(Vectorize(epsp_lambda_in), lower=0, upper=100)
integrate(Vectorize(epsp_lambda_in), lower=0, upper=10000)
integrate(Vectorize(epsp_lambda_in), lower=0, upper=1000000)
integrate(Vectorize(epsp_lambda_in), lower=0, upper=1000000000)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
integrate(epsp, 0,1000)
epsp_lambda_in <- function(s) { epsp(s)*10 }
integrate(epsp_lambda_in,0,1000)
integrate(Vectorize(epsp_lambda_in),0,1000)
integrate(Vectorize(epsp_lambda_in),0,10000)
integrate(Vectorize(epsp_lambda_in),0,10000000)
integrate(Vectorize(epsp_lambda_in),0,100000)
integrate(Vectorize(epsp_lambda_in),0,100000)?
?
integrate
integrate(Vectorize(epsp_lambda_in),0,Inf)
install.packages('cubature')
exit
s <- seq(-40,60,length.out=1000); plot(s, W(s), type="l")
W <- function(s) {
neg_ind <- s<=0
pos_ind <- s>0
if(length(neg_ind>0)) {
s[neg_ind] <- exp(s[neg_ind]/t_syn)*(Apos*(1-s[neg_ind]/t_pos_) + Aneg*(1-s[neg_ind]/t_neg_))
}
if(length(pos_ind>0)) {
s[pos_ind] <- Apos*exp(-s[pos_ind]/t_pos) + Aneg*exp(-s[pos_ind]/t_neg)
}
return(nu*s)
}
s <- seq(-40,60,length.out=1000); plot(s, W(s), type="l")
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
s <- seq(-40,60,length.out=1000); plot(s, W(s), type="l")
epsp(c(1,2,3))
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
lambda_in(c(1,2,3))
J
integrate(function(s) { epsp(s)*lambda_in(t-s) }, lower=0, upper=Inf)
t<-0; integrate(function(s) { epsp(s)*lambda_in(t-s) }, lower=0, upper=Inf)
t<-c(0,0,0,0); integrate(function(s) { epsp(s)*lambda_in(t-s) }, lower=0, upper=Inf)
M1
mf <- function(x) { x; function() x }
mf(1)
mf(1)(1)
xx <- mf(1)
xx
xx(1)
xx()
mf(1)(1)
mf(1)()
mf <- function(x) { function() x }
mf
mf(1)
mf(1)()
source('~/prog/alexeyche-junk/cns/R/sys.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/sys.R', echo=TRUE)
J
J[i]
J[09]
J[1]
J[2]
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
S_out(0)
source('~/prog/alexeyche-junk/cns/R/sys.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
S_out(0)
t<-0
integrate(function(s) { epsp(s)*lambda_in[[i]](t-s) }, lower=0, upper=Inf)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
S_out(0)
S_out(0)
S_out(2)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
S_out(2)
source('~/prog/alexeyche-junk/cns/R/sys.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
S_out(2)
S_out(1)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
corr_av_i(0,0,10)
corr_av_i(1,0,10)
source('~/prog/alexeyche-junk/cns/R/sys.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
corr_av_i(1,0,10)
lambda_in.big(i,t)
sum_over(function(j) J[j]*lambda_in.big(i,t), N) )
sum_over(function(j) J[j]*lambda_in.big(i,t), N)
J[i]*epsp(-s)
J[i]*epsp(-s)
i
i<-1
J[i]*epsp(-s)
s
s <- 10
J[i]*epsp(-s)
epsp(-s)
s
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
epsp(-s)
epsp(0)
epsp(1)
epsp(100)
epsp(10)
s<-seq(0,100, length.out=1000); s<-plot(s,epsp(s), type="l")
s<-seq(-100,100, length.out=1000); s<-plot(s,epsp(s), type="l")
s<-seq(-1,100, length.out=1000); s<-plot(s,epsp(s), type="l")
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
epsp(10)
epsp(-1)
J[i]*epsp(-s)
s
s <- 10
J[i]*epsp(-s)
lambda_in[[i]](t+s)*(v0 + J[i]*epsp(-s)+sum_over(function(j) J[j]*lambda_in.big(i,t), N) )
i
i<-1
t<-0
s<-10
corr_av_i <- function(i,t,s) {
lambda_in[[i]](t+s)*(v0 + J[i]*epsp(-s)+sum_over(function(j) J[j]*lambda_in.big(i,t), N) )
}
corr_av_i(i,t,s)
warnings()
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
epsp(c(-1,2,3,4,5))
corr_av_i(i,t,s)
J[i]*epsp(-s)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
require(sde)
dcOU
?dcOU
?dsOU
?dcOU
rcOU(n=1, Dt=0.1, x0=1, theta=c(0,2,1))
rcOU(n=10, Dt=0.1, x0=1, theta=c(0,2,1))
rcOU(n=10, Dt=0.1, x0=0, theta=c(r[1],0,1))
r
r <- c(5,6)
rcOU(n=10, Dt=0.1, x0=0, theta=c(r[1],0,1))
rcOU
?setOU
rcOU(n=10, Dt=0.1, x0=0, theta=c(r[1],1,1))
rcOU(n=100, Dt=0.1, x0=0, theta=c(r[1],1,1))
rcOU(n=100, Dt=0.1, x0=0, theta=c(r[1],1,1))
rcOU(n=100, Dt=0.1, x0=0, theta=c(r[1],1,1))
?dcOU
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
ornstein_uhlenbeck(10, 10,r[1], 1,0)
ornstein_uhlenbeck(10, 10, r[1], 1, c(0)
ornstein_uhlenbeck(10, 10, r[1], 1, c(0))
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
ornstein_uhlenbeck(10, 10, r[1], 1, 0)
ornstein_uhlenbeck(10, 10, 0.1, r[1], 1, 0)
ornstein_uhlenbeck(1, 10, 0.1, r[1], 1, 0)
ornstein_uhlenbeck(1, 100, 0.1, r[1], 1, 0)
plot(ornstein_uhlenbeck(1, 100, 0.1, r[1], 1, 0))
plot(rcOU(n=100, Dt=0.1, x0=0, theta=c(r[1],1,1)))
plot(ornstein_uhlenbeck(1, 100, 1, r[1], 1, 0))
plot(rcOU(n=100, Dt=1, x0=0, theta=c(r[1],1,1)))
plot(rcOU(n=100, Dt=0.01, x0=0, theta=c(r[1],1,1)))
plot(ornstein_uhlenbeck(1, 100, 1, r[1], 1, 0))
?rcOU
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
c(1)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
r <- c(1,2)
source('~/prog/alexeyche-junk/cns/R/poisson_process.R', echo=TRUE)
fix(c)
fix(c)
v <- -50
du <- 3
p0 <- 1
s <- seq(-70,70, length.out=1000)
g <- function(u) { p0*exp(u-v)/du}
plot(s, g(s), type='l')
s <- seq(0,70, length.out=1000)
plot(s, g(s), type='l')
s <- seq(0,50, length.out=1000)
plot(s, g(s), type='l')
s <- seq(0,10, length.out=1000)
plot(s, g(s), type='l')
s <- seq(-10,0, length.out=1000)
plot(s, g(s), type='l')
s <- seq(-70,-50, length.out=1000)
plot(s, g(s), type='l')
source('~/.active-rstudio-document', echo=TRUE)
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
setwd("~/prog/alexeyche-junk/cns/R")
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
c_part_int <- function(s) { W(s)*epsp(-s) }
c_part <- integrate(Vectorize(c_part_int),-Inf,Inf)$value
Q <-  delta_wn*c_part
delta_wn <- 0.1
Q <-  delta_wn*c_part
Q
exp(-1)
-20*exp(-1)
-11*exp(-10)
-11*exp(-10)+1
exp(-1)
-20*exp(-1)
-20*exp(-1)+10
-110*exp(-1)+10
-110*exp(-10)+10
c_part <- integrate(Vectorize(c_part_int),-Inf,Inf)$value
c_part
plot(exp(1/x))
plot(function(x) {exp(1/x)})
plot(function(x) {exp(-x)})
plot(function(x) {exp(-x/10)})
plot(function(x) {exp(-100*x)})
plot(function(x) {exp(-*x)})
plot(function(x) {exp(-x)})
Q
W0 <- integrate(W, -Inf,Inf)
W0
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
Q
Q <-  matrix(delta_wn*c_part, nrow=N, ncol=N)
Q
С <- matrix(0, nrow=N, ncol=N)
diag(C) <- c_koeff
C
C
С <- matrix(0, nrow=N, ncol=N)
C
С.0 <- matrix(0, nrow=N, ncol=N)
diag(C.0) <- c_koeff
source('~/prog/alexeyche-junk/cns/R/kempter.R', echo=TRUE)
Сm <- matrix(0, nrow=N, ncol=N)
Cm
