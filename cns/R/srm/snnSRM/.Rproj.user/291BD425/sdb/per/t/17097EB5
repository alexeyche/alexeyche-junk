{
    "contents" : "#!/usr/bin/RScript\nsetwd(\"~/prog/alexeyche-junk/cns/R/srm/new\")\n\nsource('include.R')\n\nif(!sfIsRunning()) {\n  sfInit(parallel=TRUE, cpus=10)\n  res = sfClusterEval(require('snnSRM'))\n}\n\nsfExport('constants')\ndir = \"/home/alexeyche/prog/sim/R\"\nsystem(sprintf(\"find %s -name \\\"*.png\\\" -type f -exec rm -f {} \\\\;\", dir))\n\nM = 50\nN = 10\n\ngr1 = TSNeurons(M = M, patterns = list())\n\nfile <- \"/home/alexeyche/prog/sim/stimuli/sd1.csv\"\nfile2 <- \"/home/alexeyche/prog/sim/stimuli/sd2.csv\"\ngr1$loadPattern(file, 100, 1)\ngr1$loadPattern(file2, 100, 2)\nid_m = 1:M\nid_n = (M+1):(M+N)\nstart_w = 7\nneurons = list()\nfor(i in 1:N) {\n  conn <- id_m\n  conn <- c(conn, id_n[id_n != id_n[i]]) # id of srm neurons: no self connections\n  w <- c(rep(start_w, M), rep(start_w/4, N-1))\n  neurons[[i]] = neuron(w = w, id_conn = conn, id = id_n[i])\n}\nNro = 2\nid_ro = seq(M+N+1,M+N+Nro)\nfor(i in 1:Nro) {\n  conn <- id_n\n  w <- c(rep(start_w, N))\n  neurons[[N+i]] = neuron(w = w, id_conn = conn, id = id_ro[i])\n}\n\nepochs = 50\nrun_mode = \"run\"\n#run_mode = \"learn\"\nrun_options = list(T0 = 0, Tmax = 100, dt = 0.5, learning_rate = 3, \n                   learn_window_size = 20, mode=run_mode, collect_stat=TRUE, \n                   learn_neurons=id_ro,\n                   target_function_gen = function(nspikes, class) {  \n                     function(nspike_id) { \n                       if(class == nspike_id) {\n                         return(nspikes[[nspike_id]])\n                       } else {\n                         return(NULL)\n                       }\n                     } \n                   })\n\nrun_net(neurons, gr1$patterns, epochs, run_options)\n",
    "created" : 1389083975541.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1779499597",
    "id" : "17097EB5",
    "lastKnownWriteTime" : 1389215170,
    "path" : "~/prog/alexeyche-junk/cns/R/srm/new/main.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}