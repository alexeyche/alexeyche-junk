labi = which(lab == ulabs)
ss_b = ss_b + cluster_lengths[labi]*dist_xy(centroids[labi,], global_centroid)^2
}
ss_bn
ss_b
ss_w = 0
for(lab in ulabs) {
labi = which(lab == ulabs)
cpoints = points[which(lab == labs),]
d = sapply(1:nrow(cpoints), function(i) dist_xy(cpoints[i,], centroids[labi, ]) )
ss_w = ss_w + sum(d^2)
}
labs
points
points = cbind(x,y)
ss_w = 0
for(lab in ulabs) {
labi = which(lab == ulabs)
cpoints = points[which(lab == labs),]
d = sapply(1:nrow(cpoints), function(i) dist_xy(cpoints[i,], centroids[labi, ]) )
ss_w = ss_w + sum(d^2)
}
ss_w
nrow(points)-k
k = length(ulabs)
(nrow(points)-k)/(k-1)
ss_w
ss_b
source('~/prog/alexeyche-junk/cns/cpp/scripts/eval_dist_matrix.R', echo=TRUE)
(ss_b/ss_w)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/get_sim_data.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/get_sim_data.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/get_sim_data.R', echo=TRUE)
net[101:200]
sapply(net[101:200], length)
sapply(net[101:200], length)/9000
mean(sapply(net[101:200], length)/9000)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/get_sim_data.R', echo=TRUE)
sapply(net[101:200], length)/9000
mean(sapply(net[101:200], length)/9000)
args <- commandArgs(trailingOnly = FALSE)
arg_i = grep("--args", args)
if(length(arg_i) == 0) {
f = "/home/alexeyche/prog/alexeyche-junk/cns/cpp/out.json"
} else {
f = args[arg_i+1]
}
require(rjson)
f
fromJSON(f)
fromJSON(file = f)
data = fromJSON(file = f)
data$distance_matrix
dist = do.call(rbind, data$distance_matrix)
dim(dist)
gr_pl(dist)
source('~/prog/alexeyche-junk/cns/cpp/scripts/eval_dist_matrix.R', echo=TRUE)
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2", main="Metric MDS",    type="n")
lab_cols = rainbow(length(ulabs))
text(x, y, labels = labs, cex=.7, col=lab_cols[sapply(labs, function(l) which(l == ulabs))])
points(centroids, lwd=10, pch=3, col=lab_cols)
points(global_centroid, lwd=10, pch=3, col="black")
source('~/prog/alexeyche-junk/cns/cpp/scripts/eval_dist_matrix.R', echo=TRUE)
invisible(require(rjson))
?require
require(rjson, quietly=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/scripts/eval_dist_matrix.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/scripts/eval_dist_matrix.R', echo=TRUE)
calinski_harabasz_criterion(points, ulabs, labs, centroids, global_centroid)
data$mean_rate
args
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
s1
fft(s1) * Conj(fft(s2))
plotl(fft(s1) * Conj(fft(s2))()
plot(fft(s1) * Conj(fft(s2)), type="l")
plot(abs(fft(s1) * Conj(fft(s2))), type="l")
plot(abs(fft(s1) * Conj(fft(s1))), type="l")
s1 = rnorm(10000)
plot(abs(fft(s1) * Conj(fft(s1))), type="l")
plot(Re(fft(s1) * Conj(fft(s1))), type="l")
?spec.pgram
spec.pgram(s1)
?spec.pgram
spec.pgram(s1, taper=10)
spec.pgram(s1, taper=0.5)
spec.pgram(s1, spans=c(3,5))
spec.pgram(s1, spans=c(3,10))
spec.pgram(s1, spans=c(0,5))
spec.pgram(s1, spans=c(1,5))
spec.pgram(s1, spans=c(1,100))
spec.pgram(s1, spans=c(1,10))
spec.pgram(s1, spans=c(3,10))
spec.pgram(s1, spans=c(3,100))
spec.pgram(s1, spans=c(3,1000))
?spec.pgram
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spec.taper(s1)
plot(spec.taper(s1),type="l")
plot(spec.taper(s1, p=c(3,5)),type="l")
?spec.taper
plot(spec.taper(s1, p=5,type="l")
plot(spec.taper(s1, p=5),type="l")
plot(spec.taper(s1, p=0.5),type="l")
?spec.pragm
?spec.pgram
sales.spc <- spectrum(ts.union(BJsales, BJsales.lead),
kernel("modified.daniell", c(5,7)))
ts = ts.union(BJsales, BJsales.lead)
ts
kernel("modified.daniell", c(5,7))
plotl(kernel("modified.daniell", c(5,7)))
require(Rsnn)
plotl(kernel("modified.daniell", c(5,7)))
plotl(kernel("modified.daniell", c(5,10)))
plotl(kernel("modified.daniell", c(5,7)))
plotl(kernel("modified.daniell", c(1,7)))
plotl(kernel("modified.daniell", c(5,7)))
sales.spc <- spectrum(ts.union(BJsales, BJsales.lead))
sales.spc <- spectrum(ts.union(BJsales, BJsales.lead),
kernel("modified.daniell", c(5,7)))
?spec.pgram
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
?spec.pgram
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
?spec.pgram
plot(sales.spc, plot.type = "phase")
plot(sales.spc, plot.type = "coherency")
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
plotl(fs1)
plotl(Re(fs1))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
fs1
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/gen_poisson.R', echo=TRUE)
net = gen_correlated_poisson(100)
source('gen_poisson.R')
setwd("~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts")
setwd("~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts")
source('gen_poisson.R')
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/gen_poisson.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/gen_poisson.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
net_b = sapply(1:N, function(x) rpois(len, rate/1000))
rate=10
net_b = sapply(1:N, function(x) rpois(len, rate/1000))
dim(net_b)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/gen_poisson.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
net_b = t(sapply(1:N, function(x) rpois(len, rate/1000)))
dim(net_b)
lapply(1:N, function(ni) which(net_b[ni,]== 1))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/gen_poisson.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/gen_poisson.R', echo=TRUE)
net_b = t(sapply(1:N, function(x) rpois(len, rate/1000)))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
net_b[1,]
spec.pgram(net_b[1,])
sin(10)
sin(seq(0, len))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
plotl(f)
plot(f)
plot(f,type="l")
plot(f[1:100],type="l")
f = sin(seq(0, len)/100)
plot(f[1:100],type="l")
plot(f[1:1000],type="l")
which(f == 1.0)
which(f > 0.99)
seq(0, len)/100
sin(pi/2)
seq(0, len, by=pi/100)
f = sin(seq(0, len, by=pi/100)/100)
f[1:100]
f[1:1000]
plotl(f[1:100])
plot(f[1:100])
plot(f[1:1000])
plot(f[1:10000])
?sq
?seq
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
plot(f[1:10000])
?seq
len
seq(0, len, length.out=len)
f = sin(x/10)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
plot(f[1:10000])
plot(f[1:100])
max(f)
which(f == max(f))
x = seq(0, len, by=pi/100)
x
f = sin(x/10)
f
f[1:100]
f[1:1000]
which(f==1)
pi/100
length(x)
f = sin(x)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
which(f==1)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
which(f==1)
f = sin(x) + sin(2*x-1)
plot(f[1:1000], type="l")
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
plot(f2[1:100])
plot(f[1:100])
f = sin(x)
f2 = sin(2*x-5)
plot(f2[1:100])
which(f == 1.0)
which(f2 == 1.0)
plot(f2[1:1000])
?max
pmax(f)
diff(x)
diff(f)
which(diff(f)>0)
diff(which(diff(f)>0))
dd = diff(which(diff(f)>0))
which(dd == max(dd))
diff(which(diff(f2)>0))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
f
d_fired
fi
fi
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
f
dd == max(dd)
dd
diff(which(diff(f[[fi]])>0))
diff(f[[fi]])
setwd("~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts")
source('gen_poisson.R')
N = 100
len = 10000
T = 10000
x = seq(0, T, length.out=len)
f1 = sin(x)
f2 = sin(2*x-5)
f = list(f1, f2)
diff(f[[fi]])
dd = diff(which(diff(f[[fi]])>0))
dd
diff(f[[fi]])>0
diff(f[[fi]])
f1 = sin(x)
plotl(f1)
plot(f1[1:100],type="l")
plot(f2[1:100],type="l")
setwd("~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts")
source('gen_poisson.R')
N = 100
len = 10000
T = 10000
x = seq(0, T, length.out=len)
f1 = sin(x/10)
f2 = sin(2*x/10-5)
plot(f2[1:100],type="l")
plot(f1[1:100],type="l")
f = list(f1, f2)
sp = NULL
for(fi in 1:length(f)) {
dd = diff(which(diff(f[[fi]])>0))
d_fired = dd == max(dd)
f[[fi]][d_fired] <- 1
f[[fi]][!d_fired] <- 0
}
f
net = lapply(f, function(x) which(x == 1))
net
prast(f)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
prast(f)
f
prast(net)
prast(net,T0=0,Tmax=1000)
plotl(f1[1:1000])
plotl(f2[1:1000])
fi
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
prast(net,T0=0,Tmax=1000)
fi=1
diff(which(diff(f[[fi]])>0))
which(diff(f[[fi]])>0)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
which(diff(f[[fi]])>0)
dd = diff(which(diff(f[[fi]])>0))
dd
d_fired = dd != 1
d_fired
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
f_sp[[1]]
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
colSums(f_sp)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
runif(0.1,10)
runif(1)
>sample
?sample
sample(seq(0.1,10, length.out=100))
sample(seq(0.1,10, length.out=100), 1)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
net_b[1,]
net_b[2,]
spec.pgram(net_b[1,])
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spec.pgram(net_b[1,])
ffr(net_b[1,])
fft(net_b[1,])
spectrum(f1)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(f1)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(f1)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(f1)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(f1)
spectrum(net_b[1,])
?spectrum
spectrum(net_b[1,], method="ar")
net_b[1,]
require(Rsnn)
setwd("~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts")
source('gen_poisson.R')
N = 100
len = 10000
T = 10000
x = seq(0, T, length.out=len)
net = list()
net_b = NULL
for(ni in 1:N) {
f1 = sin(x/10)
#a = sample(seq(0.1,10, length.out=100), 1)
#b = sample(seq(-10,10, length.out=100), 1)
#f2 = sin(a*x/100-b)
f = list(f1) #, f2)
f_sp = matrix(0, nrow=length(f), ncol=len)
for(fi in 1:length(f)) {
dd = diff(which(diff(f[[fi]])>0))
d_fired = dd != 1
f_sp[fi, d_fired] <- 1
f_sp[fi, !d_fired] <- 0
}
f_sp = colSums(f_sp)
net[[ni]] = which(f_sp >= 1)
net_b = rbind(net_b, f_sp)
}
prast(net,T0=0,Tmax=1000)
spectrum(net_b[1,], method="ar")
spec.pgram(net_b[1,])
spec.pgram(f1)
?spec.pgram
spec.pgram(f1, taper=0.2)
spec.pgram(net_b[1,], taper=0.2)
spec.pgram(net_b[1,], taper=0.5)
?kernel
spec.pgram(net_b[1,], kernel=rep(1,100))
?spec.pgram
?kernekl
?kernel
kernel("daniell")
plot(kernel("daniell"))
kernel(rep(1,100))
kernel("dirichlet")
kernel("dirichlet", r=10)
kernel("dirichlet", r=100)
kernel("dirichlet",m =10, r=100)
plot(kernel("dirichlet",m =10, r=100))
plot(kernel("dirichlet",m =10, r=1000))
plot(kernel("dirichlet",m =10, r=100))
plot(kernel("dirichlet",m =10, r=10))
plot(kernel("daniell", 50))
kernel("daniell", 50)
kernel()
kernel("daniel")
kernel("daniell")
?spec.pgram
spec.pgram(net_b[1,], kernel=kernel("daniell"))
spec.pgram(net_b[1,], kernel=kernel("daniell",m=100))
spec.pgram(net_b[1,], kernel=kernel("daniell",m=10))
spec.pgram(net_b[1,], kernel=kernel("daniell",m=100))
spec.pgram(net_b[1,], kernel=kernel("daniell",m=50))
spec.pgram(net_b[1,], kernel=kernel("daniell",m=2))
spec.pgram(net_b[1,])
?spec.prgram
?spec.pgram
spec.pgram(net_b[1,], spans=1:100)
spec.pgram(net_b[1,],taper=0)
spec.pgram(net_b[1,],taper=0.1)
spec.pgram(net_b[1,],taper=0.5)
spec.pgram(net_b[1,],spans=c(3,5)
spec.pgram(net_b[1,],spans=c(3,5))
spec.pgram(net_b[1,],spans=c(3,1))
spec.pgram(net_b[1,],spans=c(3,3))
spec.pgram(net_b[1,],spans=c(3,7))
spec.pgram(net_b[1,],spans=c(3,10))
s = spectrum(net_b[1,],spans=c(3,10))
f_sp
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spec.pgram(net_b[1,],spans=c(3,10))
spec.pgram(net_b[1,],spans=c(3,5))
spec.pgram(net_b[1,],spans=c(1,5))
spec.pgram(net_b[1,],spans=c(3,5))
spec.pgram(net_b[1,],spans=c(1,3))
spec.pgram(net_b[1,],spans=c(1,5))
spec.pgram(net_b[1,],spans=c(3,5))
spec.pgram(net_b[1,],spans=c(3,9))
spec.pgram(net_b[1,])
f1
prast(net)
spec.pgram(net_b[1,])
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spec.pgram(net_b[1,])
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spec.pgram(net_b[1,])
net[[1]]
diff(net[[1]])
spectrum(diff(net[[1]]))
?spec.ar
spec.ar(net_b[1,])
net_b[1,]
spec.ar(net_b[1,])
spectrum(diff(net[[1]]))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
net_b[1,]
net[[1]]
diff(net[[1]])
spectrum(diff(net[[1]]))
spectrum(net[[1]])
spectrum(net_b[1,]
spectrum(net_b[1,])
net_b[1,]
?pmtm
??pmtm
install.packages('multitaper')
require(multitaper)
??multitaper
spec.mtm(net_b[1,])
?spec.mtm
w = exp( - (seq(-2,2))^2/1 )
plotl(w)
w = exp( - (seq(-2,2, length.out=100))^2/1 )
plotl(w)
w = exp( - (seq(-2.5,2.5, length.out=100))^2/1 )
plotl(w)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
plotl(nf[1:100])
plotl(nf[1:1000])
w = exp( - (seq(-2.5,2.5, length.out=100))^2/10 )
nf = filter(net_b[1,], w, circular=FALSE)
plotl(nf[1:1000])
w = exp( - (seq(-10.0,10.0, length.out=100))^2/10 )
nf = filter(net_b[1,], w, circular=FALSE)
plotl(nf[1:1000])
w = exp( - (seq(-10.0,10.0, length.out=100))^2/20 )
nf = filter(net_b[1,], w, circular=FALSE)
plotl(nf[1:1000])
nf = filter(net_b[1,], w, circular=TRUE)
plotl(nf[1:1000])
spectrum(nf)
w = exp( - (seq(-10.0,10.0, length.out=1000))^2/20 )
nf = filter(net_b[1,], w, circular=TRUE)
plotl(nf[1:1000])
w = exp( - (seq(-10.0,10.0, length.out=100))^2/20 )
nf = filter(net_b[1,], w, circular=TRUE)
plotl(nf[1:1000])
w = exp( - (seq(-10.0,10.0, length.out=150))^2/20 )
nf = filter(net_b[1,], w, circular=TRUE)
plotl(nf[1:1000])
spectrum(nf)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(nf)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(nf)
plotl(nf[1:1000])
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
prast(net,T0=0,Tmax=1000)
net[[1]]
diff(net[[1]])
spectrum(diff(net[[1]]))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(diff(net[[1]]))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(diff(net[[1]]))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(diff(net[[1]]))
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(diff(net[[1]]))
prast(net,T0=0,Tmax=10)
prast(net,T0=0,Tmax=1000)
source('~/prog/alexeyche-junk/cns/cpp/r_package/r_scripts/cross_spectrum_dist_test.R', echo=TRUE)
spectrum(diff(net[[1]]))
prast(net,T0=0,Tmax=1000)
